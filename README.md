This is the core code for  DFPL about training steps.
